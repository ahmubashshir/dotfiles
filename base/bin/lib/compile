#!/usr/bin/make -f

FLAGS ?=
XDG_CACHE_HOME ?= $(HOME)/.cache

BINDIR := $(XDG_CACHE_HOME)/bin
SRCDIR := $(HOME)/bin/srcs
SHELL  := /bin/bash
NAME   := $(basename $(notdir $(firstword $(MAKEFILE_LIST))))

all: $(BINDIR)/$(NAME)
	@exec -a $(NAME) $(<) $(MAKECMDGOALS)

$(BINDIR)/%: $(SRCDIR)/%.c
	$(CC) $(^) -o $(@) $(FLAGS)

$(BINDIR)/%: $(SRCDIR)/%.cpp
	$(CXX) $(^) -o $(@) $(FLAGS)

@@clean@@:
	rm -f $(BINDIR)/$(NAME)

ifeq ($(firstword $(filter @@clean@@,$(MAKECMDGOALS))),)
$(MAKECMDGOALS): all
endif
